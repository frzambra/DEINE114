<!DOCTYPE html>
<html lang="en"><head>
<link href="..//imgs/R_logo.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Dr.&nbsp;Francisco Zambrano">
  <title>METE133 – Random Forest con {tidymodels}</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="../logo.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-drop/drop-runtime.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Random Forest con {tidymodels}</h1>
  <p class="subtitle">Análisis espacial con R</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Francisco Zambrano 
</div>
</div>
</div>

</section>
<section>
<section id="random-forest" class="title-slide slide level1 center" data-background-color="darkgreen">
<h1>Random Forest</h1>

</section>
<section id="qué-es-machine-learning" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>¿Qué es machine learning?</h2>

<img data-src="figs/machine_learning.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="qué-es-machine-learning-1" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>¿Qué es machine learning?</h2>

<img data-src="figs/what_is_ml.jpg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="qué-es-machine-learning-2" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>¿Qué es machine learning?</h2>

<img data-src="figs/ml_illustration.jpg" class="r-stretch"></section>
<section id="qué-es-random-forest" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>¿Qué es Random Forest?</h2>
<ul>
<li><p><code>Random Forest</code> es un método de <code>Machine Learning</code> que se utiliza principalmente para tareas de clasificación y regresión.</p></li>
<li><p>Opera construyendo múltiples <code>árboles de decisión</code> durante el entrenamiento y fusionando sus resultados para mejorar la precisión y la solidez.</p></li>
<li><p>Características clave:</p>
<ul>
<li><code>Aprendizaje conjunto</code>: Random Forest combina las predicciones de numerosos <code>árboles de decisión</code> para reducir el sobreajuste y mejorar la generalización.</li>
<li><code>Bootstrap Aggregating (Bagging)</code>: utiliza una técnica llamada <code>bagging</code>, donde se muestrean subconjuntos aleatorios de los datos de entrenamiento con reemplazo para crear diversos árboles.</li>
</ul></li>
</ul>
</section>
<section id="qué-es-random-forest-1" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>¿Qué es Random Forest?</h2>
<ul>
<li><p>Características clave:</p>
<ul>
<li><code>Aleatoriedad de predictores (features)</code>: al dividir nodos durante la construcción del árbol, Random Forest selecciona aleatoriamente un subconjunto de predictores, lo que contribuye aún más a la diversidad de los árboles.</li>
<li><code>Votación/Promedio:</code> para las tareas de clasificación, la predicción final se realiza mediante votación mayoritaria entre los árboles, mientras que para las tareas de regresión, se promedian las predicciones.</li>
<li><code>Robustez:</code> es menos sensible al ruido y puede manejar grandes conjuntos de datos con alta dimensionalidad de manera efectiva.</li>
</ul></li>
</ul>
</section>
<section id="qué-es-random-forest-2" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>¿Qué es Random Forest?</h2>
<p>Supuestos del Random Forest</p>
<ul>
<li><code>Independencia de los árboles:</code> los árboles de decisión del bosque deben ser independientes entre sí. Esto se logra mediante muestreo bootstrap y aleatoriedad de características.</li>
<li><code>Datos suficientes:</code> Random Forest requiere una gran cantidad de datos para construir diversos árboles y lograr un rendimiento óptimo.</li>
<li><code>Árboles equilibrados:</code> el algoritmo supone que los árboles individuales crecen lo suficientemente profundos como para capturar los patrones subyacentes en los datos.</li>
<li><code>Manejo de datos ruidosos:</code> Random Forest puede manejar datos ruidosos, pero supone que el ruido se distribuye aleatoriamente y no es sistemático.</li>
</ul>
</section>
<section id="qué-es-random-forest-3" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>¿Qué es Random Forest?</h2>

<img data-src="figs/decisiontree_and_randomforest.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="árboles-de-decisión" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Árboles de decisión</h2>
<blockquote>
<p>Los modelos basados en árboles son una clase de algoritmos no paramétricos que funcionan dividiendo el espacio de características en una serie de regiones más pequeñas (no superpuestas) con valores de respuesta similares utilizando un conjunto de reglas de división.</p>
</blockquote>

<img data-src="figs/decision_trees_example.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="árboles-de-decisión-1" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Árboles de decisión</h2>
<p><strong>Ejemplo simple</strong></p>

<img data-src="figs/exemplar-decision-tree.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="árboles-de-decisión-2" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Árboles de decisión</h2>
<p><strong>Estructura</strong></p>

<img data-src="figs/decision-tree-terminology.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="árboles-de-decisión-3" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Árboles de decisión</h2>
<p>Se puede utilizar para:</p>

<img data-src="figs/regression-vs-classification.jpg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="árboles-de-decisión-4" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Árboles de decisión</h2>
<h3 id="cómo-se-realiza-la-partición">¿Cómo se realiza la partición?</h3>
<p><strong>Regresión</strong></p>
<p>CART utiliza particiones recursivas binarias (es recursiva porque cada división o regla depende de las divisiones que se encuentran sobre ella).</p>
<p>El objetivo en cada nodo es encontrar la “mejor” característica <span class="math inline">\((x_i)\)</span> para dividir los datos restantes en una de dos regiones (R1 y R2) de modo que el error general entre la respuesta real <span class="math inline">\((y_i)\)</span> y la constante predicha <span class="math inline">\((c_i)\)</span> se minimiza.</p>
<p><span class="math display">\[MSE= \sum_{i \epsilon R_1}^n(Y_i-c_1)^2 +\sum_{i \epsilon R_2}^n(Y_i-c_2)^2\]</span></p>
<p>Para problemas de clasificación, la partición generalmente se realiza para maximizar la reducción de la entropía cruzada o el índice de Gini.</p>
</section>
<section id="árboles-de-decisión-5" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Árboles de decisión</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="figs/decision-stump-1.png"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="figs/decision-stump-2.png"></p>
</div>
</div>
</div>
</section>
<section id="árboles-de-decisión-6" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Árboles de decisión</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="figs/depth-3-decision-tree-1.png"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="figs/depth-3-decision-tree-2.png"></p>
</div>
</div>
</div>
</section>
<section id="árboles-de-decisión-7" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Árboles de decisión</h2>
<p><strong>¿Cuántas ramas debe tener el árbol?</strong></p>
<p>Si creamos un árbol demasiado complejo como en la figura, tendemos a sobreajustar nuestros datos de entrenamiento, lo que resulta en un rendimiento de generalización deficiente.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/deep-overfit-tree-1.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/deep-overfit-tree-2.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="árboles-de-decisión-8" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Árboles de decisión</h2>
<p><strong>¿Cuántas ramas debe tener el árbol?</strong></p>

<img data-src="figs/dt-early-stopping-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:70.0%"></section>
<section id="árboles-de-decisión-9" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Árboles de decisión</h2>
<p><strong>Un ejemplo simple con meuse</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">library</span>(sp)</span>
<span id="cb1-2"><a></a><span class="fu">library</span>(rpart)</span>
<span id="cb1-3"><a></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb1-4"><a></a><span class="fu">data</span>(meuse)</span>
<span id="cb1-5"><a></a>tree <span class="ot">&lt;-</span> <span class="fu">rpart</span>(zinc<span class="sc">~</span>dist,meuse)</span>
<span id="cb1-6"><a></a><span class="fu">rpart.plot</span>(tree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="07_random_forest_tidymodels_files/figure-revealjs/unnamed-chunk-1-1.png" width="960" class="r-stretch"></section>
<section id="random-forest-1" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Random Forest</h2>
<p><strong>¿Cómo Funciona?</strong></p>
<p><code>Bagging:</code> Bootstrap Aggregation, sirve como técnica de ensamblado/conjunto.</p>

<img data-src="figs/1_DvgOxmBc30t9HjDKFYLC0g.jpg" class="quarto-figure quarto-figure-center r-stretch" style="width:80.0%"></section>
<section id="random-forest-2" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Random Forest</h2>
<p>Pasos involucrados en Random Forest</p>
<ul>
<li><code>Paso 1:</code> en este modelo, se selecciona un subconjunto de puntos de datos y un subconjunto de características para construir cada árbol de decisión. En pocas palabras, se toman <span class="math inline">\(n\)</span> registros aleatorios y <span class="math inline">\(m\)</span> características del conjunto de datos que tiene <span class="math inline">\(k\)</span> número de registros.</li>
<li><code>Paso 2:</code> Se construyen árboles de decisión individuales para cada muestra.</li>
<li><code>Paso 3:</code> Cada árbol de decisión generará un resultado.</li>
<li><code>Paso 4:</code> El resultado final se considera en función de la votación mayoritaria (clasificación) o el promedio (regresión).</li>
</ul>
</section>
<section id="random-forest-3" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Random Forest</h2>
<p>Random Forest utiliza estimación del error out-of-bag (OOB) en cada submuestra.</p>
<ul>
<li><p>El <strong>OOB</strong> es un método utilizado para estimar el error de predicción de Random Forest.</p></li>
<li><p>Aprovecha el concepto de agregación bootstrap, donde se crean múltiples subconjuntos del conjunto de datos original mediante muestreo aleatorio con reemplazo.</p></li>
<li><p>Algunas instancias del conjunto de datos no se incluirán en estos subconjuntos para entrenar un árbol determinado.</p></li>
<li><p>Estas instancias excluidas se conocen como muestras <code>"fuera de bolsa"</code> (OOB).</p></li>
<li><p>Para cada submuestra deja ~ <span class="math inline">\(1/3\)</span> para calcular el error de predicción (validación cruzada)</p></li>
</ul>
</section>
<section id="random-forest-4" class="slide level2 smaller" data-background-image="../imgs/R_logo.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Random Forest</h2>
<p><strong>¿Por qué Random Forest es poderoso?</strong></p>
<ul>
<li><code>Precisión:</code> Random Forest a menudo proporciona una mayor precisión en comparación con los árboles de decisión individuales porque la agregación de predicciones reduce la varianza.</li>
<li><code>Robustez:</code> Es menos propenso al sobreajuste debido a la aleatoriedad introducida en los procesos de arranque y selección de características.</li>
<li><code>Versatilidad:</code> puede manejar tareas de clasificación y regresión y funciona bien con datos categóricos y numéricos.</li>
<li><code>Importancia de las características:</code> Random Forest proporciona información sobre la importancia de las diferentes características en la predicción de la variable objetivo, lo que puede resultar útil para la selección de características.</li>
</ul>
</section></section>
<section>
<section id="random-forest-con-tidymodels" class="title-slide slide level1 center" data-background-color="orange">
<h1>Random Forest con {tidymodels}</h1>

</section>
<section id="qué-es-tidymodels" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>¿Qué es {tidymodels}?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb2-2"><a></a><span class="co">#&gt; ── Attaching packages ──────────────────────────── tidymodels 1.0.0 ──</span></span>
<span id="cb2-3"><a></a><span class="co">#&gt; ✔ broom        1.0.0     ✔ rsample      1.0.0</span></span>
<span id="cb2-4"><a></a><span class="co">#&gt; ✔ dials        1.0.0     ✔ tibble       3.1.8</span></span>
<span id="cb2-5"><a></a><span class="co">#&gt; ✔ dplyr        1.0.9     ✔ tidyr        1.2.0</span></span>
<span id="cb2-6"><a></a><span class="co">#&gt; ✔ infer        1.0.2     ✔ tune         1.0.0</span></span>
<span id="cb2-7"><a></a><span class="co">#&gt; ✔ modeldata    1.0.0     ✔ workflows    1.0.0</span></span>
<span id="cb2-8"><a></a><span class="co">#&gt; ✔ parsnip      1.0.0     ✔ workflowsets 1.0.0</span></span>
<span id="cb2-9"><a></a><span class="co">#&gt; ✔ purrr        0.3.4     ✔ yardstick    1.0.0</span></span>
<span id="cb2-10"><a></a><span class="co">#&gt; ✔ recipes      1.0.1</span></span>
<span id="cb2-11"><a></a><span class="co">#&gt; ── Conflicts ─────────────────────────────── tidymodels_conflicts() ──</span></span>
<span id="cb2-12"><a></a><span class="co">#&gt; ✖ purrr::discard() masks scales::discard()</span></span>
<span id="cb2-13"><a></a><span class="co">#&gt; ✖ dplyr::filter()  masks stats::filter()</span></span>
<span id="cb2-14"><a></a><span class="co">#&gt; ✖ dplyr::lag()     masks stats::lag()</span></span>
<span id="cb2-15"><a></a><span class="co">#&gt; ✖ recipes::step()  masks stats::step()</span></span>
<span id="cb2-16"><a></a><span class="co">#&gt; • Use tidymodels_prefer() to resolve common conflicts.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="qué-es-tidymodels-1" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>¿Qué es {tidymodels}?</h2>

<img data-src="figs/tidymodels_que_es.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"></section>
<section id="el-juego-completo" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>El juego completo</h2>

<img data-src="figs/tidy_models_whole_game.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="división-en-entrenamiento-y-testeo" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>División en entrenamiento y testeo</h2>
<p>Para el aprendizaje automático, normalmente dividimos los datos en conjuntos de entrenamiento y testeo:</p>
<div class="fragment">
<ul>
<li>El <strong>set de entrenamiento</strong> se utiliza para estimar los parámetros del modelo.</li>
<li>El <strong>set de testeo</strong> se utiliza para encontrar una evaluación independiente del rendimiento del modelo.</li>
</ul>
</div>
<div class="fragment">
<p>No 🚫 utilice el set de testeo durante el entrenamiento.</p>
</div>
</section>
<section id="división-en-entrenamiento-y-testeo-1" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>División en entrenamiento y testeo</h2>

<img data-src="figs/split_test_train.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="división-en-entrenamiento-y-testeo-2" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>División en entrenamiento y testeo</h2>
<ul>
<li>Utilizar demasiados datos en <strong>entrenamiento</strong> nos impide calcular una buena evaluación del <strong>rendimiento</strong> predictivo.</li>
</ul>
<div class="fragment">
<ul>
<li>Utilizar demasiados datos en <strong>testeo</strong> nos impide calcular una buena estimación de los <strong>parámetros</strong> del modelo.</li>
</ul>
</div>
</section>
<section id="división-en-entrenamiento-y-testeo-3" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>División en entrenamiento y testeo</h2>
<p><strong>Con los datos de meuse</strong></p>
<p>Hagamos la división de los datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-2"><a></a>meuse_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(meuse)</span>
<span id="cb3-3"><a></a>meuse_split</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Training/Testing/Total&gt;
&lt;116/39/155&gt;</code></pre>
</div>
</div>
</section>
<section id="división-en-entrenamiento-y-testeo-4" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>División en entrenamiento y testeo</h2>
<p><strong>Con los datos de meuse</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>meuse_train <span class="ot">&lt;-</span> <span class="fu">training</span>(meuse_split)</span>
<span id="cb5-2"><a></a>meuse_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(meuse_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="especificar-un-modelo" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Especificar un modelo</h2>
<p><strong>Especificar un modelo</strong></p>
<ul>
<li><p>Elegir el modelo</p></li>
<li><p>Elegir el motor</p></li>
<li><p>Elegir el modo</p></li>
</ul>
<p>Todos los modelos disponibles se enumeran en <a href="https://www.tidymodels.org/find/parsnip/">https://www.tidymodels.org/find/parsnip/</a></p>
</section>
<section id="especificar-un-modelo-1" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Especificar un modelo</h2>
</section>
<section id="modelo-de-flujo-de-trabajo-workflow" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Modelo de flujo de trabajo (workflow)</h2>
<p>Los flujos de trabajo manejan datos nuevos mejor que las herramientas básicas de R en términos de nuevos niveles de factores</p>
<div class="fragment">
<ul>
<li>Puedes usar otros preprocesadores además de fórmulas (avanzados)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Pueden ayudar a organizar su trabajo cuando trabaje con varios modelos.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><u>Lo más importante</u>, un flujo de trabajo captura todo el proceso de modelado: <code>fit()</code> y <code>predict()</code> se aplican a los pasos de preprocesamiento además del ajuste real del modelo.</li>
</ul>
</div>
</section>
<section id="modelo-de-flujo-de-trabajo-workflow-1" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Modelo de flujo de trabajo (workflow)</h2>
<p>Sin workflows</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>rf_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a></a>  <span class="fu">set_mode</span>(<span class="st">'regression'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a></a>  <span class="fu">set_engine</span>(<span class="st">'ranger'</span>)</span>
<span id="cb6-4"><a></a></span>
<span id="cb6-5"><a></a>rf_spec <span class="sc">|&gt;</span> </span>
<span id="cb6-6"><a></a>  <span class="fu">fit</span>(zinc<span class="sc">~</span>dist<span class="sc">+</span>soil,<span class="at">data =</span> meuse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>parsnip model object

Ranger result

Call:
 ranger::ranger(x = maybe_data_frame(x), y = y, num.threads = 1,      verbose = FALSE, seed = sample.int(10^5, 1)) 

Type:                             Regression 
Number of trees:                  500 
Sample size:                      155 
Number of independent variables:  2 
Mtry:                             1 
Target node size:                 5 
Variable importance mode:         none 
Splitrule:                        variance 
OOB prediction error (MSE):       59221.39 
R squared (OOB):                  0.5604868 </code></pre>
</div>
</div>
</section>
<section id="modelo-de-flujo-de-trabajo-workflow-2" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Modelo de flujo de trabajo (workflow)</h2>
<p>Usando workflows</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a><span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a></a>  <span class="fu">add_formula</span>(zinc <span class="sc">~</span> dist<span class="sc">+</span>soil ) <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a></a>  <span class="fu">add_model</span>(rf_spec) <span class="sc">|&gt;</span> </span>
<span id="cb8-4"><a></a>  <span class="fu">fit</span>(<span class="at">data =</span> meuse_train) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow [trained] ══════════════════════════════════════════════════════════
Preprocessor: Formula
Model: rand_forest()

── Preprocessor ────────────────────────────────────────────────────────────────
zinc ~ dist + soil

── Model ───────────────────────────────────────────────────────────────────────
Ranger result

Call:
 ranger::ranger(x = maybe_data_frame(x), y = y, num.threads = 1,      verbose = FALSE, seed = sample.int(10^5, 1)) 

Type:                             Regression 
Number of trees:                  500 
Sample size:                      116 
Number of independent variables:  2 
Mtry:                             1 
Target node size:                 5 
Variable importance mode:         none 
Splitrule:                        variance 
OOB prediction error (MSE):       63550.63 
R squared (OOB):                  0.5241185 </code></pre>
</div>
</div>
</section>
<section id="predecir-utilizando-el-modelo-entrenado" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Predecir utilizando el modelo entrenado</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a>rf_fit <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a></a>  <span class="fu">add_formula</span>(zinc <span class="sc">~</span> dist<span class="sc">+</span>soil ) <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a></a>  <span class="fu">add_model</span>(rf_spec) <span class="sc">|&gt;</span> </span>
<span id="cb10-4"><a></a>  <span class="fu">fit</span>(<span class="at">data =</span> meuse_train) </span>
<span id="cb10-5"><a></a></span>
<span id="cb10-6"><a></a><span class="fu">predict</span>(rf_fit, <span class="at">new_data =</span> meuse_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 39 × 1
   .pred
   &lt;dbl&gt;
 1  962.
 2  830.
 3  461.
 4  450.
 5  228.
 6  223.
 7  830.
 8  966.
 9  966.
10  223.
# ℹ 29 more rows</code></pre>
</div>
</div>
</section>
<section id="evaluar-las-predicciones" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Evaluar las predicciones</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a><span class="fu">augment</span>(rf_fit, <span class="at">new_data =</span> meuse_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 39 × 15
   .pred      x      y cadmium copper  lead  zinc  elev    dist    om ffreq
 * &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;
 1  962. 181072 333611    11.7     85   299  1022  7.91 0.00136  13.6 1    
 2  830. 181025 333558     8.6     81   277  1141  6.98 0.0122   14   1    
 3  461. 181165 333537     6.5     68   199   640  7.8  0.103    13   1    
 4  450. 181060 333231     2.4     37   133   347  8.67 0.185    10.6 1    
 5  228. 181232 333168     1.6     24    80   183  9.05 0.310     6.3 1    
 6  223. 181191 333115     1.4     25    86   189  9.02 0.315     6.4 1    
 7  830. 180694 332972     7.1     69   148   711  7.1  0.0122   16   1    
 8  966. 180625 332847     8.7     69   207   735  7.02 0        13.7 1    
 9  966. 180555 332707    12.9     95   284  1052  6.86 0        14.8 1    
10  223. 180973 332687     1.3     24    67   180  8.74 0.321     4.4 1    
# ℹ 29 more rows
# ℹ 4 more variables: soil &lt;fct&gt;, lime &lt;fct&gt;, landuse &lt;fct&gt;, dist.m &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="evaluar-las-predicciones-1" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Evaluar las predicciones</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a>data_ev <span class="ot">&lt;-</span> <span class="fu">augment</span>(rf_fit, <span class="at">new_data =</span> meuse_test)</span>
<span id="cb14-2"><a></a><span class="fu">ggplot</span>(data_ev,<span class="fu">aes</span>(.pred,zinc)) <span class="sc">+</span> </span>
<span id="cb14-3"><a></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb14-4"><a></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span><span class="dv">1</span>,<span class="at">lty=</span><span class="st">'dashed'</span>) <span class="sc">+</span> </span>
<span id="cb14-5"><a></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="07_random_forest_tidymodels_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch"></section>
<section id="evaluar-las-predicciones-2" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Evaluar las predicciones</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>En el set de entrenamiento</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a><span class="fu">augment</span>(rf_fit, <span class="at">new_data =</span> meuse_train) <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a></a>  <span class="fu">metrics</span>(<span class="at">truth =</span> .pred, </span>
<span id="cb15-3"><a></a>        <span class="at">estimate =</span> zinc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 rmse    standard     214.   
2 rsq     standard       0.684
3 mae     standard     149.   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>En el set de testeo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a><span class="fu">augment</span>(rf_fit, <span class="at">new_data =</span> meuse_test) <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a></a>  <span class="fu">metrics</span>(<span class="at">truth =</span> .pred, </span>
<span id="cb17-3"><a></a>        <span class="at">estimate =</span> zinc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 rmse    standard     219.   
2 rsq     standard       0.663
3 mae     standard     141.   </code></pre>
</div>
</div>
</div></div>
</section>
<section id="evaluar-las-predicciones-3" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Evaluar las predicciones</h2>
<p><strong>Remuestreo</strong></p>

<img data-src="figs/resampling.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="evaluar-las-predicciones-4" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Evaluar las predicciones</h2>
<p><strong>Remuestreo</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb19-2"><a></a>meuse_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(meuse_train, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb19-3"><a></a>meuse_folds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#  10-fold cross-validation 
# A tibble: 10 × 2
   splits           id    
   &lt;list&gt;           &lt;chr&gt; 
 1 &lt;split [104/12]&gt; Fold01
 2 &lt;split [104/12]&gt; Fold02
 3 &lt;split [104/12]&gt; Fold03
 4 &lt;split [104/12]&gt; Fold04
 5 &lt;split [104/12]&gt; Fold05
 6 &lt;split [104/12]&gt; Fold06
 7 &lt;split [105/11]&gt; Fold07
 8 &lt;split [105/11]&gt; Fold08
 9 &lt;split [105/11]&gt; Fold09
10 &lt;split [105/11]&gt; Fold10</code></pre>
</div>
</div>
</section>
<section id="evaluar-las-predicciones-5" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Evaluar las predicciones</h2>
<p><strong>Remuestreo</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a></a>rf_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a></a>  <span class="fu">add_formula</span>(zinc <span class="sc">~</span> dist<span class="sc">+</span>soil ) <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a></a>  <span class="fu">add_model</span>(rf_spec) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a>meuse_res <span class="ot">&lt;-</span> <span class="fu">fit_resamples</span>(rf_wf, meuse_folds)</span>
<span id="cb22-2"><a></a>meuse_res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Resampling results
# 10-fold cross-validation 
# A tibble: 10 × 4
   splits           id     .metrics         .notes          
   &lt;list&gt;           &lt;chr&gt;  &lt;list&gt;           &lt;list&gt;          
 1 &lt;split [104/12]&gt; Fold01 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt;
 2 &lt;split [104/12]&gt; Fold02 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt;
 3 &lt;split [104/12]&gt; Fold03 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt;
 4 &lt;split [104/12]&gt; Fold04 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt;
 5 &lt;split [104/12]&gt; Fold05 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt;
 6 &lt;split [104/12]&gt; Fold06 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt;
 7 &lt;split [105/11]&gt; Fold07 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt;
 8 &lt;split [105/11]&gt; Fold08 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt;
 9 &lt;split [105/11]&gt; Fold09 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt;
10 &lt;split [105/11]&gt; Fold10 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt;</code></pre>
</div>
</div>
</section>
<section id="evaluar-las-predicciones-6" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Evaluar las predicciones</h2>
<p><strong>Remuestreo</strong></p>
<p>Podemos medir la calidad de las predicciones utilizando sólo remuestreo!!</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a>meuse_res <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a></a>  <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  .metric .estimator    mean     n std_err .config             
  &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 rmse    standard   241.       10 24.0    Preprocessor1_Model1
2 rsq     standard     0.469    10  0.0662 Preprocessor1_Model1</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Si comparamos con las métricas en el set de entrenamiento y de testeo.</p>
<p>En set de entrenamiento RMSE = 214 y <span class="math inline">\(R^2\)</span>=0.684.</p>
<p>En set de testeo RMSE = 219 y <span class="math inline">\(R^2\)</span>=0.66.</p>
</div></div>
</section>
<section id="el-ajuste-final" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>El ajuste final</h2>
<ul>
<li><p>Supongamos que estamos contentos con nuestro modelo de bosque aleatorio.</p></li>
<li><p>Ajustemos el modelo en el conjunto de entrenamiento y verifiquemos nuestro desempeño usando el conjunto de prueba.</p></li>
<li><p>He mostrado las funciones <code>fit()</code> y <code>predict()</code> (<code>+ augment()</code>) pero hay un atajo:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a>final_fit <span class="ot">&lt;-</span> <span class="fu">last_fit</span>(rf_wf, meuse_split) </span>
<span id="cb26-2"><a></a>final_fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Resampling results
# Manual resampling 
# A tibble: 1 × 6
  splits           id               .metrics .notes   .predictions .workflow 
  &lt;list&gt;           &lt;chr&gt;            &lt;list&gt;   &lt;list&gt;   &lt;list&gt;       &lt;list&gt;    
1 &lt;split [116/39]&gt; train/test split &lt;tibble&gt; &lt;tibble&gt; &lt;tibble&gt;     &lt;workflow&gt;</code></pre>
</div>
</div>
</section>
<section id="el-ajuste-final-1" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>El ajuste final</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a></a><span class="fu">collect_metrics</span>(final_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  .metric .estimator .estimate .config             
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 rmse    standard     217.    Preprocessor1_Model1
2 rsq     standard       0.667 Preprocessor1_Model1</code></pre>
</div>
</div>
<div class="fragment">
<p>Estas son las métricas calculadas sobre el <code>set de testeo</code>.</p>
</div>
</section>
<section id="el-ajuste-final-2" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>El ajuste final</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a></a><span class="fu">collect_predictions</span>(final_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 39 × 5
   .pred id                .row  zinc .config             
   &lt;dbl&gt; &lt;chr&gt;            &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;               
 1  972. train/test split     1  1022 Preprocessor1_Model1
 2  838. train/test split     2  1141 Preprocessor1_Model1
 3  466. train/test split     3   640 Preprocessor1_Model1
 4  448. train/test split     9   347 Preprocessor1_Model1
 5  229. train/test split    10   183 Preprocessor1_Model1
 6  226. train/test split    11   189 Preprocessor1_Model1
 7  838. train/test split    18   711 Preprocessor1_Model1
 8  977. train/test split    19   735 Preprocessor1_Model1
 9  977. train/test split    20  1052 Preprocessor1_Model1
10  225. train/test split    28   180 Preprocessor1_Model1
# ℹ 29 more rows</code></pre>
</div>
</div>
</section>
<section id="el-ajuste-final-3" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>El ajuste final</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a></a><span class="fu">extract_workflow</span>(final_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow [trained] ══════════════════════════════════════════════════════════
Preprocessor: Formula
Model: rand_forest()

── Preprocessor ────────────────────────────────────────────────────────────────
zinc ~ dist + soil

── Model ───────────────────────────────────────────────────────────────────────
Ranger result

Call:
 ranger::ranger(x = maybe_data_frame(x), y = y, num.threads = 1,      verbose = FALSE, seed = sample.int(10^5, 1)) 

Type:                             Regression 
Number of trees:                  500 
Sample size:                      116 
Number of independent variables:  2 
Mtry:                             1 
Target node size:                 5 
Variable importance mode:         none 
Splitrule:                        variance 
OOB prediction error (MSE):       63939.99 
R squared (OOB):                  0.5212029 </code></pre>
</div>
</div>
<div class="fragment">
<p>Utilizar este modelo para realizar las predicciones.</p>
</div>
</section>
<section id="todo-el-juego" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Todo el juego</h2>

<img data-src="figs/tidy_models_whole_game.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="ajustar-los-parámetros-del-modelo" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Ajustar los parámetros del modelo</h2>
<p>Algunos parámetros del modelo o de preprocesamiento no se pueden estimar directamente a partir de los datos.</p>
<p>Algunos ejemplos:</p>
<ul>
<li><p>Profundidad del árbol en árboles de decisión</p></li>
<li><p>Número de vecinos en un modelo de vecino K-más cercano</p></li>
</ul>
</section>
<section id="optimizar-los-parámetros-del-modelo" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Optimizar los parámetros del modelo</h2>
<ul>
<li><p>Pruebe diferentes valores y mida su desempeño.</p></li>
<li><p>Encuentre buenos valores para estos parámetros.</p></li>
<li><p>Una vez que se determinan los valores de los parámetros, se puede finalizar un modelo ajustándolo a todo el conjunto de entrenamiento.</p></li>
</ul>
</section>
<section id="optimizar-los-parámetros-del-modelo-1" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Optimizar los parámetros del modelo</h2>
<p>Las dos estrategias principales de optimización son:</p>
<div class="fragment">
<ul>
<li><p><strong>Búsqueda de cuadrícula (grid search)</strong> 💠 que prueba un conjunto predefinido de valores candidatos</p></li>
<li><p><strong>Búsqueda iterativa (iterative search)</strong> 🌀 que sugiere/estima nuevos valores de parámetros candidatos para evaluar</p></li>
</ul>
</div>
</section>
<section id="optimizar-los-parámetros-del-modelo-2" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Optimizar los parámetros del modelo</h2>
<p>Probemos con el modelo de Random Forest para <code>meuse</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a></a>rf_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>(</span>
<span id="cb34-2"><a></a>  <span class="at">tree =</span> <span class="dv">1000</span>,</span>
<span id="cb34-3"><a></a>  <span class="at">mtry =</span> <span class="fu">tune</span>(),</span>
<span id="cb34-4"><a></a>  <span class="at">min_n =</span> <span class="fu">tune</span>()</span>
<span id="cb34-5"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb34-6"><a></a>  <span class="fu">set_mode</span>(<span class="st">'regression'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb34-7"><a></a>  <span class="fu">set_engine</span>(<span class="st">'ranger'</span>,<span class="at">importance =</span><span class="st">'impurity'</span>)</span>
<span id="cb34-8"><a></a></span>
<span id="cb34-9"><a></a>rf_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb34-10"><a></a>  <span class="fu">add_formula</span>(zinc <span class="sc">~</span> dist<span class="sc">+</span>soil) <span class="sc">|&gt;</span> </span>
<span id="cb34-11"><a></a>  <span class="fu">add_model</span>(rf_spec) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="optimizar-los-parámetros-del-modelo-3" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Optimizar los parámetros del modelo</h2>
<p>Probemos con el modelo de Random Forest para <code>meuse</code>.</p>
</section>
<section id="optimizar-los-parámetros-del-modelo-4" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Optimizar los parámetros del modelo</h2>

<img data-src="07_random_forest_tidymodels_files/figure-revealjs/unnamed-chunk-23-1.png" width="960" class="r-stretch"></section>
<section id="optimizar-los-parámetros-del-modelo-5" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Optimizar los parámetros del modelo</h2>
<p>Inspeccionando los resultados y seleccionad el de mejor calidad</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 8
   mtry min_n .metric .estimator  mean     n std_err .config             
  &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1     2    36 rmse    standard    236.    10    27.6 Preprocessor1_Model1
2     1    15 rmse    standard    238.    10    23.8 Preprocessor1_Model5
3     1    18 rmse    standard    238.    10    23.7 Preprocessor1_Model2
4     2    29 rmse    standard    239.    10    26.5 Preprocessor1_Model4
5     1     3 rmse    standard    243.    10    23.9 Preprocessor1_Model3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a></a>mejores_param <span class="ot">&lt;-</span> <span class="fu">select_best</span>(rf_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ajuste-final" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Ajuste final</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a></a>rf_wf <span class="ot">&lt;-</span> <span class="fu">finalize_workflow</span>(rf_wf, mejores_param)</span>
<span id="cb37-2"><a></a>final_fit <span class="ot">&lt;-</span> <span class="fu">last_fit</span>(rf_wf, meuse_split) </span>
<span id="cb37-3"><a></a></span>
<span id="cb37-4"><a></a><span class="fu">collect_metrics</span>(final_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  .metric .estimator .estimate .config             
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 rmse    standard     216.    Preprocessor1_Model1
2 rsq     standard       0.662 Preprocessor1_Model1</code></pre>
</div>
</div>
</section>
<section id="importancia-de-las-variables" class="slide level2 smaller" data-background-image="https://juliasilge.github.io/tidymodels-tutorial/slides/hexes/tidymodels.png" data-background-position="97.5% 2.5%" data-background-size="7.5%" data-layout="true">
<h2>Importancia de las variables</h2>

<img data-src="07_random_forest_tidymodels_files/figure-revealjs/unnamed-chunk-27-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="random-forest-para-interpolación-espacial" class="title-slide slide level1 center" data-background-color="gray">
<h1>Random Forest para interpolación espacial</h1>

</section>
<section id="motivación" class="slide level2">
<h2>Motivación</h2>
<p><img data-src="figs/spRF_Hengl_et_al.png">{fig-align = ‘center’}</p>

<div class="quarto-auto-generated-content">
<p><img src="../imgs/logo_hemera_2024.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-drop/drop-runtime.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'drop': {"button":true,"shortcut":"]","engine":"webr","webr":{"packages":[]},"pyodide":{"packages":[]}},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealDrop, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>